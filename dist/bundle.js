!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hyperlink=t():e.Hyperlink=t()}(self,(()=>(()=>{"use strict";var e={124:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(358),o=n.n(i),s=n(69),r=n.n(s)()(o());r.push([e.id,".ce-inline-tool-hyperlink-wrapper {\n    outline: none;\n    border: 0;\n    border-radius: 0 0 4px 4px;\n    margin: 0;\n    font-size: 13px;\n    padding: 10px;\n    width: 300px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    display: none;\n    font-weight: 500;\n    border-top: 1px solid rgba(201,201,204,.48);\n}\n\n.ce-inline-tool-hyperlink-wrapper.ce-inline-tool-hyperlink-wrapper--showed {\n    display: block;\n}\n\n.ce-inline-tool-hyperlink--input,\n.ce-inline-tool-hyperlink--select-target {\n    border: 1px solid rgba(201,201,204,.48);\n    -webkit-box-shadow: inset 0 1px 2px 0 rgba(35,44,72,.06);\n    box-shadow: inset 0 1px 2px 0 rgba(35,44,72,.06);\n    border-radius: 5px;\n    padding: 5px 8px;\n    margin-bottom: 10px;\n    outline: none;\n    width: 100%;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n}\n\n.ce-inline-tool-hyperlink--select-target {\n    width: 100%;\n    display: inline-block;\n}\n.ce-inline-tool-hyperlink--select-target {\n    margin-right: 2%;\n}\n\n.ce-inline-tool-hyperlink--select-rel {\n    display: flex;\n    flex-wrap: wrap;\n    margin-bottom: 10px;\n}\n\n.ce-inline-tool-hyperlink--checkbox-label {\n    display: flex;\n    flex: 50%;\n    padding: 3px 10px;\n    align-items: center;\n}\n.ce-inline-tool-hyperlink--checkbox-input {\n    margin: 0 5px 0 0 !important;\n}\n\n.ce-inline-tool-hyperlink--button {\n    display: block;\n    width: 100%;\n    background-color: #34c38f;\n    color: #fff;\n    padding: 7px 0;\n    border: none;\n    text-align: center;\n    text-decoration: none;\n    font-size: 16px;\n    border-radius: 5px;\n    cursor: pointer;\n}\n",""]);const a=r},69:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,o,s){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&r[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},358:e=>{e.exports=function(e){return e[1]}},146:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var s={},r=[],a=0;a<e.length;a++){var l=e[a],c=i.base?l[0]+i.base:l[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=o(p,i);i.byIndex=a,t.splice(a,0,{identifier:u,updater:g,references:1})}r.push(u)}return r}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var s=i(e=e||[],o=o||{});return function(e){e=e||[];for(var r=0;r<s.length;r++){var a=n(s[r]);t[a].references--}for(var l=i(e,o),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},769:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},765:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},201:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},85:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},889:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={id:i,exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var i={};return(()=>{n.d(i,{default:()=>m});class e{constructor(){this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}isElement(e){return e&&"object"==typeof e&&e.nodeType&&e.nodeType===Node.ELEMENT_NODE}isContentEditable(e){return"true"===e.contentEditable}isNativeInput(e){return!(!e||!e.tagName)&&["INPUT","TEXTAREA"].includes(e.tagName)}canSetCaret(e){let t=!0;if(this.isNativeInput(e))switch(e.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":t=!1}else t=this.isContentEditable(e);return t}CSS(){return{editorWrapper:"codex-editor",editorZone:"codex-editor__redactor"}}anchorNode(){const e=window.getSelection();return e?e.anchorNode:null}anchorElement(){const e=window.getSelection();if(!e)return null;const t=e.anchorNode;return t?this.isElement(t)?t:t.parentElement:null}anchorOffset(){const e=window.getSelection();return e?e.anchorOffset:null}isCollapsed(){const e=window.getSelection();return e?e.isCollapsed:null}isAtEditor(){const t=e.get();let n=t.anchorNode||t.focusNode;n&&n.nodeType===Node.TEXT_NODE&&(n=n.parentNode);let i=null;return n&&(i=n.closest(`.${e.CSS.editorZone}`)),i&&i.nodeType===Node.ELEMENT_NODE}isSelectionExists(){return!!e.get().anchorNode}static get range(){const e=window.getSelection();return e&&e.rangeCount?e.getRangeAt(0):null}static get rect(){let e,t=document.selection,n={x:0,y:0,width:0,height:0};if(t&&"Control"!==t.type)return e=t.createRange(),n.x=e.boundingLeft,n.y=e.boundingTop,n.width=e.boundingWidth,n.height=e.boundingHeight,n;if(!window.getSelection)return n;if(t=window.getSelection(),null===t.rangeCount||isNaN(t.rangeCount))return n;if(0===t.rangeCount)return n;if(e=t.getRangeAt(0).cloneRange(),e.getBoundingClientRect&&(n=e.getBoundingClientRect()),0===n.x&&0===n.y){const t=document.createElement("span");if(t.getBoundingClientRect){t.appendChild(document.createTextNode("â€‹")),e.insertNode(t),n=t.getBoundingClientRect();const i=t.parentNode;i.removeChild(t),i.normalize()}}return n}static get text(){return window.getSelection?window.getSelection().toString():""}get(){return window.getSelection()}setCursor(e,t=0){const n=document.createRange(),i=window.getSelection();if(this.isNativeInput(e)){if(!this.canSetCaret(e))return;return e.focus(),e.selectionStart=e.selectionEnd=t,e.getBoundingClientRect()}return n.setStart(e,t),n.setEnd(e,t),i.removeAllRanges(),i.addRange(n),n.getBoundingClientRect()}removeFakeBackground(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}setFakeBackground(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}save(){this.savedSelectionRange=e.range}restore(){if(!this.savedSelectionRange)return;const e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedSelectionRange)}clearSaved(){this.savedSelectionRange=null}collapseToEnd(){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(e.focusNode),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}findParentTag(e,t=null,n=10){const i=window.getSelection();let o=null;return i&&i.anchorNode&&i.focusNode?([i.anchorNode,i.focusNode].forEach((i=>{let s=n;for(;s>0&&i.parentNode&&(i.tagName!==e||(o=i,t&&i.classList&&!i.classList.contains(t)&&(o=null),!o));)i=i.parentNode,s--})),o):null}expandToTag(e){const t=window.getSelection();t.removeAllRanges();const n=document.createRange();n.selectNodeContents(e),t.addRange(n)}}var t=n(146),o=n.n(t),s=n(85),r=n.n(s),a=n(769),l=n.n(a),c=n(201),d=n.n(c),u=n(765),h=n.n(u),p=n(889),g=n.n(p),f=n(124),b={};b.styleTagTransform=g(),b.setAttributes=d(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=h(),o()(f.Z,b),f.Z&&f.Z.locals&&f.Z.locals;class m{constructor({data:t,config:n,api:i,readOnly:o}){this.toolbar=i.toolbar,this.inlineToolbar=i.inlineToolbar,this.tooltip=i.tooltip,this.i18n=i.i18n,this.config=n,this.selection=new e,this.commandLink="createLink",this.commandUnlink="unlink",this.CSS={wrapper:"ce-inline-tool-hyperlink-wrapper",wrapperShowed:"ce-inline-tool-hyperlink-wrapper--showed",button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--link",buttonUnlink:"ce-inline-tool--unlink",input:"ce-inline-tool-hyperlink--input",selectTarget:"ce-inline-tool-hyperlink--select-target",selectRel:"ce-inline-tool-hyperlink--select-rel",checkboxLabel:"ce-inline-tool-hyperlink--checkbox-label",checkboxInput:"ce-inline-tool-hyperlink--checkbox-input",buttonSave:"ce-inline-tool-hyperlink--button"},this.targetAttributes=this.config.availableTargets||[{text:"New window",value:"_blank"},{text:"Current frame",value:"_self"},{text:"Parent frame",value:"_parent"},{text:"Top frame",value:"_top"}],this.relAttributes=this.config.availableRels||["alternate","author","bookmark","external","help","license","next","nofollow","noreferrer","noopener","prev","search","tag"],this.nodes={button:null,wrapper:null,input:null,selectTarget:null,selectRel:null,buttonSave:null},this.inputOpened=!1}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(this.iconSvg("link",14,10)),this.nodes.button.appendChild(this.iconSvg("unlink",15,11)),this.nodes.button}renderActions(){this.nodes.wrapper=document.createElement("div"),this.nodes.wrapper.classList.add(this.CSS.wrapper),this.nodes.input=document.createElement("input"),this.nodes.input.placeholder="https://...",this.nodes.input.classList.add(this.CSS.input),this.nodes.input.addEventListener("blur",this.onBlur.bind(this)),this.nodes.selectTarget=document.createElement("select"),this.nodes.selectTarget.classList.add(this.CSS.selectTarget),this.addOption(this.nodes.selectTarget,{text:this.i18n.t("Select target"),value:""});for(const e of this.targetAttributes)this.addOption(this.nodes.selectTarget,e);this.config.target&&(0===this.targetAttributes.length&&this.addOption(this.nodes.selectTarget,this.config.target),this.nodes.selectTarget.value=this.config.target.value),this.nodes.selectRel=document.createElement("div"),this.nodes.selectRel.classList.add(this.CSS.selectRel);for(const e of this.relAttributes)this.addCheckbox(this.nodes.selectRel,e,e);return this.config.rel&&0===this.relAttributes.length&&this.addCheckbox(this.nodes.selectTarget,this.config.rel,this.config.rel,!0),this.nodes.buttonSave=document.createElement("button"),this.nodes.buttonSave.type="button",this.nodes.buttonSave.classList.add(this.CSS.buttonSave),this.nodes.buttonSave.innerHTML=this.i18n.t("Save"),this.nodes.buttonSave.addEventListener("click",(e=>{this.savePressed(e)})),this.nodes.wrapper.appendChild(this.nodes.input),this.targetAttributes&&this.targetAttributes.length>0&&this.nodes.wrapper.appendChild(this.nodes.selectTarget),this.relAttributes&&this.relAttributes.length>0&&this.nodes.wrapper.appendChild(this.nodes.selectRel),this.nodes.wrapper.appendChild(this.nodes.buttonSave),this.nodes.wrapper}surround(e){if(e){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());const e=this.selection.findParentTag("A");if(e)return this.selection.expandToTag(e),this.unlink(),this.closeActions(),this.checkState(),void this.toolbar.close()}this.toggleActions()}get shortcut(){return this.config.shortcut||"CMD+L"}get title(){return"Hyperlink"}static get isInline(){return!0}static get sanitize(){return{a:{href:!0,target:!0,rel:!0}}}checkState(e=null){const t=this.selection.findParentTag("A");if(t){this.nodes.button.classList.add(this.CSS.buttonUnlink),this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();const e=t.getAttribute("href"),n=t.getAttribute("target"),i=(t.getAttribute("rel")||"").split(" ");this.nodes.input.value=e||"",this.nodes.selectTarget.value=n||"";for(const e of this.nodes.selectRel.getElementsByClassName(this.CSS.checkboxInput))e.checked=-1!==i.indexOf(e.dataset.rel);this.selection.save()}else this.nodes.button.classList.remove(this.CSS.buttonUnlink),this.nodes.button.classList.remove(this.CSS.buttonActive);return!!t}clear(){this.closeActions()}toggleActions(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}openActions(e=!1){this.nodes.wrapper.classList.add(this.CSS.wrapperShowed),e&&this.nodes.input.focus(),this.inputOpened=!0}onBlur(){const e=this.nodes.input.value||"";if(this.config.validate&&1==!!this.config.validate&&!this.validateURL(e))return this.tooltip.show(this.nodes.input,this.i18n.t("The URL is not valid."),{placement:"top"}),void setTimeout((()=>{this.tooltip.hide()}),1e3);"function"==typeof this.config.configure&&Promise.resolve(this.config.configure(e)).then((e=>{if(e.href&&(this.nodes.input.value=e.href),"string"==typeof e.target&&(this.nodes.selectTarget.value=e.target),"object"==typeof e.rels){const t={};if(e.rels instanceof Array)for(const n of e.rels)t[n]=!0;else Object.assign(t,e.rels);for(const e of this.nodes.selectRel.getElementsByClassName(this.CSS.checkboxInput))e.dataset.rel in t&&(e.checked=t[e.dataset.rel])}}))}closeActions(t=!0){if(this.selection.isFakeBackgroundEnabled){const t=new e;t.save(),this.selection.restore(),this.selection.removeFakeBackground(),t.restore()}this.nodes.wrapper.classList.remove(this.CSS.wrapperShowed),this.nodes.input.value="",this.nodes.selectTarget.value="";for(const e of this.nodes.selectRel.getElementsByClassName(this.CSS.checkboxInput))e.checked=!1;t&&this.selection.clearSaved(),this.inputOpened=!1}savePressed(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();let t=this.nodes.input.value||"",n=this.nodes.selectTarget.value||"";const i=[];for(const e of this.nodes.selectRel.getElementsByClassName(this.CSS.checkboxInput))e.checked&&i.push(e.dataset.rel);return t.trim()?this.config.validate&&1==!!this.config.validate&&!this.validateURL(t)?(this.tooltip.show(this.nodes.input,this.i18n.t("The URL is not valid."),{placement:"top"}),void setTimeout((()=>{this.tooltip.hide()}),1e3)):(t=this.prepareLink(t),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(t,n,i.join(" ")),this.selection.collapseToEnd(),void this.inlineToolbar.close()):(this.selection.restore(),this.unlink(),e.preventDefault(),void this.closeActions())}validateURL(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}prepareLink(e){return e=e.trim(),this.addProtocol(e)}addProtocol(e){if(/^(\w+):(\/\/)?/.test(e))return e;const t=/^\/[^/\s]?/.test(e),n="#"===e.substring(0,1),i=/^\/\/[^/\s]/.test(e);return t||n||i||(e="http://"+e),e}insertLink(e,t="",n=""){let i=this.selection.findParentTag("A");i?this.selection.expandToTag(i):(document.execCommand(this.commandLink,!1,e),i=this.selection.findParentTag("A")),i&&(t?i.target=t:i.removeAttribute("target"),n?i.rel=n:i.removeAttribute("rel"))}unlink(){document.execCommand(this.commandUnlink)}iconSvg(e,t=14,n=14){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.classList.add("icon","icon--"+e),i.setAttribute("width",t+"px"),i.setAttribute("height",n+"px"),i.innerHTML=`<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#${e}"></use>`,i}addOption(e,t){let n=document.createElement("option");n.text=t.text,n.value=t.value,e.add(n)}addCheckbox(e,t,n,i=!1){let o=document.createElement("input");o.type="checkbox",o.classList.add(this.CSS.checkboxInput),o.dataset.rel=n,o.checked=i;const s=document.createElement("label");s.classList.add(this.CSS.checkboxLabel),s.appendChild(o),s.insertAdjacentText("beforeend",t),e.appendChild(s)}}})(),i.default})()));
